{% extends "layout.html" %}

{% block content %}
<div class="container">

    <h1>{{ title }}</h1>

    {% if current_user.is_authenticated and current_user.is_host %}
        <a href="{{ url_for('events.create_event') }}" class="btn btn-create">Create New Event</a>
    {% endif %}

    {% set has_events = false %}

    {% for group_name, group_events in groups.items() %}
        {% if group_events %}
            {% set has_events = true %}
            <h2 class="event-group-title">{{ group_name }}</h2>

            {% for event in group_events %}
            <div class="event-card">
                <h3>
                    <a href="{{ url_for('events.event_detail', event_id=event.id) }}">
                        {{ event.title }}
                    </a>
                </h3>

                <p><strong>Date:</strong> {{ event.date }}</p>
                <p><strong>Host:</strong> {{ event.host }}</p>
                <p class="description">{{ event.description }}</p>

                {% if current_user.is_authenticated and current_user.is_host %}
                    <a href="{{ url_for('events.edit_event', event_id=event.id) }}" class="btn btn-edit">Edit</a>
            
                    <form method="POST"
                        action="{{ url_for('events.delete_event', event_id=event.id) }}"
                        style="display:inline;">
                        <button type="submit" class="btn btn-delete">Delete</button>
                    </form>
                {% else %}
                 <!-- Hide from guests â€” nothing rendered -->
                {% endif %}
            </div>
            {% endfor %}
        {% endif %}
    {% endfor %}

</div>
{% endblock %}
